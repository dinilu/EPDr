<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Diego Nieto Lugilde" />

<meta name="date" content="2017-07-03" />

<title>Working with multiple entities</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Working with multiple entities</h1>
<h4 class="author"><em>Diego Nieto Lugilde</em></h4>
<h4 class="date"><em>2017-07-03</em></h4>


<div id="TOC">
<ul>
<li><a href="#searching-for-entities"><span class="toc-section-number">1</span> Searching for entities</a></li>
<li><a href="#retrieving-data-for-multiple-entities"><span class="toc-section-number">2</span> Retrieving data for multiple entities</a></li>
<li><a href="#standardizing-data-across-multiple-entities"><span class="toc-section-number">3</span> Standardizing data across multiple entities</a><ul>
<li><a href="#filtering-and-discarding-entities"><span class="toc-section-number">3.1</span> Filtering and discarding entities</a></li>
<li><a href="#selecting-chronologies-and-standardizing-the-taxonomy"><span class="toc-section-number">3.2</span> Selecting chronologies and standardizing the taxonomy</a></li>
<li><a href="#standardizing-counts-to-percentages"><span class="toc-section-number">3.3</span> Standardizing counts to percentages</a></li>
<li><a href="#standardizing-time-of-counts-data-interpolation-or-averaging"><span class="toc-section-number">3.4</span> Standardizing time of counts data (interpolation or averaging)</a></li>
<li><a href="#calculating-data-quality-blois_2011"><span class="toc-section-number">3.5</span> Calculating data quality <span class="citation">(Blois et al. 2011)</span></a></li>
</ul></li>
<li><a href="#plotting-and-preparing-output-data"><span class="toc-section-number">4</span> Plotting and preparing output data</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p>In a <a href="EPDr-Tutorial.html">previous tutorial</a>, we have illustrated how to use the EPDr package to work with data of single entities (e.g., sediment cores) in the European Pollen Database (EPD). However and as in many other databases from international efforts, the spatial extent of the EPD makes it suitable for integrative studies where data from multiple entities can be analyzed together. <code>EPDr</code> does not provide specific objects to store such data, but this can be easily accomplished in R using <code>list</code> objects and functions in the <code>lapply</code> family. <code>EPDr</code> does, however, provide some functions to work on list of <code>epd.entity.df</code> objects. Here, we ilustrate how to combine <code>EPDr</code> with <code>list</code> objects and <code>lapply</code> functions, and how to use the <code>EPDr</code> functions that work on lists of objects.</p>
<div id="searching-for-entities" class="section level1">
<h1><span class="header-section-number">1</span> Searching for entities</h1>
<p>The very first thing is to load the library and stablish a valid connection to the database server. Remember that this need to be done for each session we start, and that it automatically closes the connection if we re-start R session and/or Rstudio.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(EPDr)
epd.connection &lt;-<span class="st"> </span><span class="kw">connect_to_epd</span>(<span class="dt">database =</span> <span class="st">&quot;epd&quot;</span>,
                                 <span class="dt">user =</span> <span class="st">&quot;epdr&quot;</span>,
                                 <span class="dt">password =</span> <span class="st">&quot;epdrpw&quot;</span>)</code></pre></div>
<p>Then, you need to identify the ids for the entities of interest (i.e., <code>e_</code>). Here, the <code>list_</code> functions, and specially <code>list_e</code>, are your friends. For instance, if you want to work in a specific country. First, you can check which countries are represented in the EPD.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list_countries</span>(epd.connection)</code></pre></div>
<pre><code>##    poldiv1                                   name
## 1      ADS                           Adriatic Sea
## 2      AFG                            Afghanistan
## 3      ALA                         Ãland Islands
## 4      ALB                                Albania
## 5      AND                                Andorra
## 6      ARE                   United Arab Emirates
## 7      ARM                                Armenia
## 8      ATO                         Atlantic ocean
## 9      AUT                                Austria
## 10     AZE                             Azerbaijan
## 11     BEL                                Belgium
## 12     BGR                               Bulgaria
## 13     BHR                                Bahrain
## 14     BIH                 Bosnia and Herzegovina
## 15     BLR                                Belarus
##  [ reached getOption(&quot;max.print&quot;) -- omitted 75 rows ]</code></pre>
<p>Once you know the exact spelling of the country names of interest, you can pass them as an argument to the <code>list_e</code> function to get the list of all entities ids that fall into your study area.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">e_ids &lt;-<span class="st"> </span><span class="kw">list_e</span>(epd.connection,
                <span class="dt">country =</span> <span class="kw">c</span>(<span class="st">&quot;Spain&quot;</span>, <span class="st">&quot;Portugal&quot;</span>))
e_ids &lt;-<span class="st"> </span>e_ids<span class="op">$</span>e_</code></pre></div>
<blockquote>
<p>Note that <code>list_</code> functions return a data.frame (table) from where we only need the entities ids. This is the reason we subset in the second line to extract just the numbers in the <code>e_</code> column.</p>
</blockquote>
<p>Alternatively, you could filter entities by any other criteria accepted by <code>list_e</code> check <code>?list_e</code> for further details. On the contrary, if you were interested to work with the whole EPD, you could just query the whole entities ids without passing any searching criteria to the function, which would return all entities.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># e_ids &lt;- list_e(epd.connection)</span>
<span class="co"># e_ids &lt;- e_ids$e_</span></code></pre></div>
<blockquote>
<p>Note that we did not run this example, and just provide it to acknowledge the posibility.</p>
</blockquote>
</div>
<div id="retrieving-data-for-multiple-entities" class="section level1">
<h1><span class="header-section-number">2</span> Retrieving data for multiple entities</h1>
<p>Now, you can use the <code>lapply</code> function combined with <code>get_entity</code> to receive a list of <code>epd.entity</code> objects for all the entities of interest.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_all &lt;-<span class="st"> </span><span class="kw">lapply</span>(e_ids, get_entity, epd.connection)
<span class="kw">class</span>(epd_all)</code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(epd_all[[<span class="dv">1</span>]])</code></pre></div>
<pre><code>## [1] &quot;epd.entity&quot;
## attr(,&quot;package&quot;)
## [1] &quot;EPDr&quot;</code></pre>
<p>Now, we can use the <code>entity_to_matrices</code> function to calculate the <code>epd.entity.df</code> objects from the list of <code>epd.entity</code> objects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_all &lt;-<span class="st"> </span><span class="kw">lapply</span>(epd_all, entity_to_matrices)
<span class="kw">class</span>(epd_all[[<span class="dv">1</span>]])</code></pre></div>
<pre><code>## [1] &quot;epd.entity.df&quot;
## attr(,&quot;package&quot;)
## [1] &quot;EPDr&quot;</code></pre>
</div>
<div id="standardizing-data-across-multiple-entities" class="section level1">
<h1><span class="header-section-number">3</span> Standardizing data across multiple entities</h1>
<p>Because each entity may have been analyzed by different researcher (with different taxonomical/morphological criteria, interests, etc.), these data need to be standardized before any analysis can be carried out.</p>
<div id="filtering-and-discarding-entities" class="section level2">
<h2><span class="header-section-number">3.1</span> Filtering and discarding entities</h2>
<p><code>EPDr</code> provides several functions that work on list of <code>EPDr</code> objects (<code>epd.entity</code> or <code>epd.entity.df</code>) that facilitate that standardization. For instance, you might decide to not use entities with some restrictions on their use. The <code>remove_restricted</code> function look into all the objects in a list and return only those that are unrestricted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(epd_all)</code></pre></div>
<pre><code>## [1] 93</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vapply</span>(epd_all, check_restriction, <span class="dt">FUN.VALUE=</span><span class="kw">logical</span>(<span class="dv">1</span>))</code></pre></div>
<pre><code>##  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [12] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [23] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [ reached getOption(&quot;max.print&quot;) -- omitted 63 entries ]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_all &lt;-<span class="st"> </span><span class="kw">remove_restricted</span>(epd_all)
<span class="kw">length</span>(epd_all)</code></pre></div>
<pre><code>## [1] 82</code></pre>
<blockquote>
<p>Note that we have lost five entities, that have restricted the use of the data.</p>
</blockquote>
<p>Usually, you will also remove all the entities that have no ages for the biological counts. You can use here the <code>remove_wo_ages</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vapply</span>(epd_all, check_default_chron, <span class="dt">FUN.VALUE=</span><span class="kw">logical</span>(<span class="dv">1</span>))</code></pre></div>
<pre><code>##  [1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
## [12]  TRUE  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE
## [23]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
##  [ reached getOption(&quot;max.print&quot;) -- omitted 52 entries ]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_all &lt;-<span class="st"> </span><span class="kw">remove_wo_ages</span>(epd_all)
<span class="kw">length</span>(epd_all)</code></pre></div>
<pre><code>## [1] 60</code></pre>
<blockquote>
<p>Note that we have removed another 22 entities for which there are no ages.</p>
</blockquote>
<p>Now, you may need to know what are exactly the entities you have lost in these filters. You can use the <code>extract_e</code> and <code>vapply</code> functions to get a list of the entities id numbers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vapply</span>(epd_all, extract_e, <span class="dt">FUN.VALUE=</span><span class="kw">numeric</span>(<span class="dv">1</span>))</code></pre></div>
<pre><code>##  [1]   33   44   56   58   68   80   97   98  184  189  216  244  284  366
## [15]  469  470  471  539  556  572  574  616  651  660  820  891  892  893
## [29]  894  918  919  926  927  931  969 1050 1053 1394 1483 1553 1554 1556
## [43] 1560 1561 1562 1565 1566 1568 1569 1570 1629 1828 2034 2169 2246 2247
## [57] 2256 2321 2324 2326</code></pre>
</div>
<div id="selecting-chronologies-and-standardizing-the-taxonomy" class="section level2">
<h2><span class="header-section-number">3.2</span> Selecting chronologies and standardizing the taxonomy</h2>
<p>Becasue, Giesecke <em>et al.</em> <span class="citation">(2013)</span> provides updated chronologies for a lot of entities, we want to be sure to use those chronologies when they are available. To do so, we need to change the default chronology in each object to <code>9999</code> (specific number for giesecke) when available.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_all &lt;-<span class="st"> </span><span class="kw">lapply</span>(epd_all, giesecke_default_chron)</code></pre></div>
<p>Next, let assume we are interested in pollen data. Here, we need to combine again <code>filter_taxagroups</code> function with <code>lapply</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_all &lt;-<span class="st"> </span><span class="kw">lapply</span>(epd_all, filter_taxagroups,
                  <span class="kw">c</span>(<span class="st">&quot;HERB&quot;</span>, <span class="st">&quot;TRSH&quot;</span>, <span class="st">&quot;DWAR&quot;</span>, <span class="st">&quot;LIAN&quot;</span>,
                    <span class="st">&quot;HEMI&quot;</span>, <span class="st">&quot;UPHE&quot;</span>, <span class="st">&quot;INUN&quot;</span>))</code></pre></div>
<blockquote>
<p>Taxagroups represented here are all different type of pollen from plants of different life-forms: HERB for herbs, TRSH for trees and shrubs, DWARF for dwarf shrubs, LIAN for lianas, HEMI for hemiparasitic, and UPHE for upland herbs, and INUN for indeterminables and unknowns.</p>
</blockquote>
<p>Now, we can change each taxa name in the objects for the accepted name according to the EPD, using the combination of the <code>lapply</code> and <code>taxa_to_accepted</code> functions. You could also modify the taxonomy to the higher taxonomical level using <code>taxa_to_highertaxa</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd.taxonomy &lt;-<span class="st"> </span><span class="kw">get_taxonomy_epd</span>(epd.connection)
epd_all &lt;-<span class="st"> </span><span class="kw">lapply</span>(epd_all, taxa_to_acceptedtaxa, epd.taxonomy)</code></pre></div>
<p>Finally, we want to all entities reflecting the same taxa. <code>unify_taxonomy</code> work on list of <code>epd.entity.df</code> objects. It looks for the taxa in all the objects and increment all datasets to reflect the same taxa in all. Taxa present in one entity but not in others are included with value = <code>0</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_all &lt;-<span class="st"> </span><span class="kw">unify_taxonomy</span>(epd_all, epd.taxonomy)</code></pre></div>
</div>
<div id="standardizing-counts-to-percentages" class="section level2">
<h2><span class="header-section-number">3.3</span> Standardizing counts to percentages</h2>
<p>The following would be to transform raw pollen counts into pollen percentages. Here, again, we combine the <code>lapply</code> function with the <code>counts_to_percentages</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_all &lt;-<span class="st"> </span><span class="kw">lapply</span>(epd_all, counts_to_percentages)</code></pre></div>
</div>
<div id="standardizing-time-of-counts-data-interpolation-or-averaging" class="section level2">
<h2><span class="header-section-number">3.4</span> Standardizing time of counts data (interpolation or averaging)</h2>
<p>Because each entity in our list will have samples at different ages, if we need to run an analysis with sites refering to the same time period, we need to standardize the ages across all <code>epd.entity.df</code> objects in the list. Here, you can use <code>lapply</code> combined with <code>interpolate_counts</code> or <code>intervals_counts</code> depending on the objectives of your study. Here, we will illustrate the use of <code>interpolate_counts</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_all &lt;-<span class="st"> </span><span class="kw">lapply</span>(epd_all, interpolate_counts, <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">22000</span>, <span class="dt">by =</span> <span class="dv">1000</span>))
epd_all[[<span class="dv">2</span>]]<span class="op">@</span>commdf<span class="op">@</span>counts[, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>]</code></pre></div>
<pre><code>##         Abies Acacia Acaulon-type Acer campestre-type Aconitum
## 1          NA     NA           NA                  NA       NA
## 2  0.00000000      0            0          1.39720947        0
## 3  1.83791892      0            0          0.39529099        0
## 4  1.18775746      0            0          0.84607573        0
## 5  0.63630773      0            0          0.39241748        0
## 6  0.06739453      0            0          0.46121602        0
## 7  0.00000000      0            0          0.11370232        0
##    Aconitum napellus-type Aconitum-group
## 1                      NA             NA
## 2                       0              0
## 3                       0              0
## 4                       0              0
## 5                       0              0
## 6                       0              0
## 7                       0              0
##  [ reached getOption(&quot;max.print&quot;) -- omitted 16 rows ]</code></pre>
<blockquote>
<p>Note that here we request to get a pollen concentration for every 500 years since 22000 to 0 calibrated years BP. For those entities with data partially covering this range, the data falling outside of the range are filled with <code>NA</code> to acknowledge that this periods are outside of the real data range.</p>
</blockquote>
</div>
<div id="calculating-data-quality-blois_2011" class="section level2">
<h2><span class="header-section-number">3.5</span> Calculating data quality <span class="citation">(Blois et al. 2011)</span></h2>
<p>Counting data have at least one source of uncertainty associated: the age estimated for each sample comes from an age-depth model fit using control data (e.g., radiocarbon data or any other geochronological information). In the case of interpolated data, the uncertainty have a second dimension, depending on how far (in time) we are interpolating countings from a real sample. <span class="citation">(Blois et al. 2011)</span> proposed an index to summarize these two uncertainties. See <code>?blois_quality</code> and Blois <em>et al.</em> <span class="citation">(2011)</span> for details. <code>EPDr</code> provides a function to calculate data quality according to the Blois index (<code>blois_quality</code>) on <code>epd.entity.df</code> objects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_all[[<span class="dv">1</span>]]<span class="op">@</span>agesdf<span class="op">@</span>dataquality</code></pre></div>
<pre><code>## data frame with 0 columns and 0 rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_all &lt;-<span class="st"> </span><span class="kw">lapply</span>(epd_all, blois_quality)
epd_all[[<span class="dv">1</span>]]<span class="op">@</span>agesdf<span class="op">@</span>dataquality</code></pre></div>
<pre><code>##        blois
## 1  0.9968825
## 2  0.9807100
## 3  0.9117075
## 4  0.8855600
## 5  0.9788300
## 6  0.8965075
## 7  0.8957825
## 8  0.9531375
## 9  0.9003275
## 10 0.8504375
##  [ reached getOption(&quot;max.print&quot;) -- omitted 13 rows ]</code></pre>
<blockquote>
<p>The basic interpretation of the index is that closer to 1 is high quality data, whereas close to 0 is poor quality data.</p>
</blockquote>
</div>
</div>
<div id="plotting-and-preparing-output-data" class="section level1">
<h1><span class="header-section-number">4</span> Plotting and preparing output data</h1>
<p>When all standardizations have been accomplished, the data can be prepared for further analysis by preparing tables or can be plotted in the form of maps, for instance.</p>
<p>In the first version of the package, <code>EPDr</code> have a function called <code>table_by_taxa_age</code> that allow to search in a <code>epd.entity.df</code> object and extract the data for a particular taxa and sample (by the sample label).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_tables &lt;-<span class="st"> </span><span class="kw">lapply</span>(epd_all,
                     table_by_taxa_age,
                     <span class="kw">c</span>(<span class="st">&quot;Quercus&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;1000&quot;</span>, <span class="st">&quot;2000&quot;</span>))
epd_tables[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>##   e_ londd latdd      count sample_label    taxa
## 1 33 -6.15 43.05 0.00000000         1000 Quercus
## 2 33 -6.15 43.05 0.07800232         2000 Quercus</code></pre>
<p>Note that this function returns a list of tables with the entity number, coordinates for that entity (londd and latdd), count, sample_label and taxa. You can combine all those tables into a single one, by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">epd_table &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, epd_tables)
epd_table</code></pre></div>
<pre><code>##       e_     londd    latdd        count sample_label    taxa
## 1     33 -6.150000 43.05000  0.000000000         1000 Quercus
## 2     33 -6.150000 43.05000  0.078002316         2000 Quercus
## 3     44 -6.733333 42.10000  0.000000000         1000 Quercus
##  [ reached getOption(&quot;max.print&quot;) -- omitted 117 rows ]</code></pre>
<p>This function is also used internally in the <code>map_taxa_age</code> function, which use the data prepared in this way to plot a map of the pollen counts for a particular taxa in a particular time period. In this case, the <code>map_taxa_age</code> was designed to work on list of <code>epd.entity.df</code> objects. Passing the list of objects, the desired taxa name, and the desired age label of interest will produce a <code>ggplot</code> map with pollen counts.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_taxa_age</span>(epd_all, <span class="st">&quot;Pinus&quot;</span>, <span class="st">&quot;1000&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<blockquote>
<p>Note that the function automatically recognize that counts are in percentages, and properly acknoledge that in the legend. If the counts were not converted into percentages, the function will plot differently to accomodate this sort of data. Note also how entities without data for that particular time period are plotted with NA (small dark grey dots).</p>
</blockquote>
<p>While other functions ignore multiple taxa names or entity ids, the <code>map_taxa_age</code> function accept multiple taxa names, but not sample labels. When multiple taxa names are provided, the plot represent the sum of all those taxa passed to the function. This can be usefull when taxonomy has not been standardized or we are interested in data at higher taxonomical levels than those recognized by the EPD taxonomy.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pinus &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Pinus&quot;</span>, <span class="st">&quot;Pinus diploxylon-type&quot;</span>, <span class="st">&quot;Pinus halepensis-type&quot;</span>,
           <span class="st">&quot;Pinus haploxylon-type&quot;</span>, <span class="st">&quot;Pinus nigra-type&quot;</span>,
           <span class="st">&quot;Pinus pinaster-type&quot;</span>, <span class="st">&quot;Pinus pinea-type&quot;</span>)
<span class="kw">map_taxa_age</span>(epd_all, pinus, <span class="st">&quot;1000&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<blockquote>
<p>Note how some entities show now a higher value when putting all <em>Pinus</em> species in the same map.</p>
</blockquote>
<p>The function also allow for ‘on the fly’ conversion to presence absence maps, by using a threshold to transform pollen counts (or percentages) into presence-absence data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_taxa_age</span>(epd_all, pinus, <span class="st">&quot;1000&quot;</span>, <span class="dt">pres_abse =</span> T, <span class="dt">pollen_thres =</span> <span class="dv">0</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<blockquote>
<p>Note how the legend of the map acknoledge the use and value of a threshold. Here, the default value is zero.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_taxa_age</span>(epd_all, pinus, <span class="st">&quot;1000&quot;</span>, <span class="dt">pres_abse =</span> T, <span class="dt">pollen_thres =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<blockquote>
<p>Note the differences in the map when changing the pollen threshold from the default (zero) to 1, and how this change is acknoledge in the legend.</p>
</blockquote>
<p>The function allows for many other configuration on dots colors, sizes, etc. It also allow to zoom into particular areas using coordinates. For a full description on all these map tunning arguments check <code>?map_taxa_age</code>.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-blois_2011">
<p>Blois, Jessica L., John W. (Jack) Williams, Eric C. Grimm, Stephen T. Jackson, and Russell W. Graham. 2011. “A Methodological Framework for Assessing and Reducing Temporal Uncertainty in Paleovegetation Mapping from Late-Quaternary Pollen Records.” <em>Quaternary Science Reviews</em> 30 (15): 1926–39. doi:<a href="https://doi.org/10.1016/j.quascirev.2011.04.017">10.1016/j.quascirev.2011.04.017</a>.</p>
</div>
<div id="ref-giesecke_2013">
<p>Giesecke, Thomas, Basil Davis, Simon Brewer, Walter Finsinger, Steffen Wolters, Maarten Blaauw, Jacques-Louis de Beaulieu, et al. 2013. “Towards Mapping the Late Quaternary Vegetation Change of Europe.” <em>Vegetation History and Archaeobotany</em> 23 (1): 75–86. doi:<a href="https://doi.org/10.1007/s00334-012-0390-y">10.1007/s00334-012-0390-y</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
